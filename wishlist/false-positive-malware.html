<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD>
<TITLE>PuTTY semi-bug false-positive-malware</TITLE>
<link rel="canonical" href="https://www.chiark.greenend.org.uk/~sgtatham/putty/wishlist/false-positive-malware.html">
<link rel="stylesheet" type="text/css" href="../sitestyle.css" title="PuTTY Home Page Style">
<link rel="shortcut icon" href="putty.ico">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex,nofollow">
</HEAD>
<BODY>
<h1 align=center>PuTTY semi-bug false-positive-malware</h1>

<div align=center class="mirrorwarning">
This is a mirror. Follow this link to find
<a href="https://www.chiark.greenend.org.uk/~sgtatham/putty/">the primary PuTTY web site</a>.
</div>

<p align=center>

<a href="../">Home</a>
 |

<a href="../faq.html">FAQ</a>
 |

<a href="../feedback.html">Feedback</a>
 |

<a href="../licence.html">Licence</a>
 |

<a href="../maillist.html">Updates</a>
 |

<a href="../mirrors.html">Mirrors</a>
 |

<a href="../keys.html">Keys</a>
 |

<a href="../links.html">Links</a>
 |

<a href="../team.html">Team</a>
<br>
Download:

<a href="../latest.html">Stable</a>
 &#183;

<a href="../snapshot.html">Snapshot</a>
 |

<a href="../docs.html">Docs</a>
 |

<a href="../changes.html">Changes</a>
 |

<a href="./">Wishlist</a>
</p>

<b>summary</b>: PuTTY is persistently misreported as malware<br>
<b>class</b>: <i>semi-bug:</i> This might or might not be a bug, depending on your precise definition of what a bug is.<br>
<b>difficulty</b>: <i>mayhem:</i> Probably impossible<br>
<b>priority</b>: <i>high:</i> This should be fixed in the next release.<br>
<p>
PuTTY seems to have a persistent problem with virus-scanning software.
Most release builds of the PuTTY tools in the last few years have been
accused by one or more virus checker of being malware of some kind.

<p>
Top-level summary: We have every reason to believe that <em>all</em>
of these reports are false positives. As far as we know, the
legitimate, signed builds of PuTTY are free of malware and safe to
use. But we don't know why these reports happen; we don't even know
whether it's because of anything <em>we</em> are doing; so we also
don't know what – if anything – we can do to stop them.

<h2>History</h2>

<p>
Here's a list of accusations we have observed ourselves, or had
reported to us by users.

<ul>

<li>0.76 (as of August 2021):
<ul>
<li>According to Antiy-AVL: Trojan/Generic.ASMalwS.347CCB5
<li>According to McAfee: GenericRXAA-FA!B3BB91AD96F2 (McAfee have since confirmed this was a false positive, and removed it)
</ul>

<li>0.74 (as of February 2021):
<ul>
<li>According to Malwarebytes: Malware.Generic.622351592
<li>According to Antiy-AVL: Trojan/Win32.Swrort
<li>According to Jiangmin: Trojan.Generic.fppbc
<li>According to Rising: Trojan.Generic@ML.90 (RDML:L2kuAr0kZuIw8c+l3U6LAA)
<li>According to SentinelOne: DFI - Suspicious PE
<li>According to Yandex: Trojan.Rozena!HzkpdhLd3Ls
<li>According to Zillya: Trojan.Metla.Win32.216
<li>According to Yomi Hunter: Trojan.Shelma!6FgIvXQ353M
</ul>

<li>0.70 (as of July 2017):
<ul>
<li>According to Avira: TR/Crypt.XPACK.Gen
<li>According to Baidu: Win32.Trojan.WisdomEyes.16070401.9500.9972
<li>According to Rising: Malware.Heuristic!ET#86% (rdm+)
<li>According to Ikarus: Win32.Outbreak
</ul>

<li>0.69 (as of May 2017):
<ul>
<li>According to DrWeb: Trojan.PWS.Siggen1.64270
<li>Malwarebytes was also reported to have blocked our download server
<code>the.earth.li</code>, though another report said that upgrading
Malwarebytes fixed it
</ul>

<li>0.68 (as of Apr 2017):
<ul>
<li>According to ClamAV: Win.Trojan.Generic-6296445-0
<li>According to TrendMicro: HT_RAZY_GC280119.UVPM
<li>According to VBA32: Trojan.Shelma
<li>According to Zillya: Trojan.Shelma.Win32.582
</ul>

<li>0.67 (as of Mar 2016):
<ul>
<li>According to ClamAV: Win.Trojan.Rozena-1115
</ul>

<li>0.66 (as of Mar 2016):
<ul>
<li>According to ClamAV: Win.Trojan.Rozena-1138
</ul>

<li>0.65 (as of Aug 2015):
<ul>
<li>According to ClamAV: Win.Trojan.Rozena-1108
</ul>

<li>0.64 (as of Feb 2015):
<ul>
<li>According to ClamAV: PUA.Spyware.XPCSpyPro, PUA.Win32.Packer.Armadillo-59, Win.Trojan.Rozena-1094
<li>According to NANO-Antivirus: Trojan.Win32.Swrort.dlnmjx
<li>According to Zillya: Trojan.Horst.Win32.1
<li>According to nProtect: Backdoor/W32.Swrort.200704
</ul>

</ul>

<p>
Of course, we weren't able to investigate most of these claims,
because proprietary antivirus organisations don't provide much
information we could use, and undoubtedly would say they have sound
security reasons for keeping quiet. So we mostly don't know what might
have caused all those people to flag PuTTY as malware.

<p>
ClamAV is a partial exception: because it's free software, we were at
least able to find the entries in its database that caused four
successive releases of <code>putty.exe</code> to be flagged as various
kinds of Win.Trojan.Rozena-NNNN. When we did, it turned out that each
of those accusations was based on ClamAV's database containing an MD5
hash of the code segment of the corresponding <code>putty.exe</code>.
In other words, it wasn't that PuTTY was exhibiting any kind of
general behaviour or matching a general pattern that made it look like
malware; it's that ClamAV's database was identifying <em>PuTTY
specifically</em> as malware, apparently on purpose – there is
no way that a database entry of that kind could have matched anything
<em>other</em> than the specific PuTTY executable in question.

<p>
In several cases, we submitted a false-positive report to ClamAV, and
they withdrew the database entry in question. And then, the next time
we put out a release, they turned round and flagged that one as
another kind of Rozena.

<h2>Analysis</h2>

<p>
It would be nice if we could give some explanation here of
<em>why</em> antivirus software is so keen to call us names.
Unfortunately, we don't know!

<p>
Some possibilities that have occurred to us in the past include:
<ul>
<li><strong>Old build tools?</strong> PuTTY was built with Visual Studio 2003 for a long time, and that also meant it didn't have up-to-date executable security features like ASLR and DEP enabled. We wondered if that might be considered an indicator of malware. But then we upgraded to Visual Studio 2015 and that didn't stop the accusations.
<li><strong>No code signing?</strong> We also wondered if antivirus people had adopted a default policy of extreme suspicion towards any unsigned Windows executable. But when we started code-signing PuTTY, the accusations didn't stop.
<li><strong>Incorporation into real malware?</strong> We've heard in the past that at least one real piece of malware had reused PuTTY or pieces of it (among other legitimate communications software) as a means of keeping in touch with its command and control servers. Perhaps that was enough to get the legitimate PuTTY tarred with the same brush? But that surely wouldn't explain the ongoing deliberate flagging of <em>every release</em> as a new kind of virus.
<li><strong>Download by real malware?</strong> Another possibility is that some piece of malware might cause an infected machine to <em>download</em> PuTTY and then use it (which we know <em>has</em> happened at least once), and that this is causing virus checkers to assume the PuTTY executable being downloaded is guilty by association. That <em>would</em> plausibly explain the immediate flagging of each new release, if the malware is using our recommended URL that redirects to the latest version.
<li><strong>Strange API usage patterns?</strong> PuTTY uses the Windows API in some unusual ways. For example, it collects various data from around the system to seed its cryptographic random number generator (a policy dating from before CryptGenRandom was available, and still used <em>as well</em> as CryptGenRandom). Also, it loads a lot of standard Windows DLLs at run time rather than load time, partly as a DLL hijacking defence and partly as a means of retaining support for old Windows versions. Perhaps one of those, or some other particular thing we're doing with the Windows API, is causing all this suspicion? But we don't have any clues other than our own guesswork to imagine what it might be.
<li><strong>Campaign of harassment?</strong> Of course, we can't actually rule out the possibility of malice rather than disorganisation: perhaps somebody somewhere is <em>intentionally</em> trying to get legitimate security tools flagged as malware for some reason (perhaps to discourage people from using them?). We don't have any specific evidence for this, but it's a big Internet and there's plenty of room for a bad actor or two. It would be interesting to know if any other security projects have similar problems.
</ul>

<p>
Of course, the other possibility is that the accusations might be
<em>right</em>, and that there really is malware in PuTTY, either
because it managed to get on to our build machine and infected the
binaries at build time, or else (someone might imagine) because we put
it there on purpose.

<p>
We don't believe that is true, and here are some reasons why:
<ul>
<li><strong>Our build setup does not involve Windows!</strong> As of
0.70, PuTTY's build process for Windows executables and installers
goes from source code to digitally signed build products entirely on
Linux, without involving Windows or even WINE at any point. (We use
<code>clang-cl</code> as a compiler, and run the WiX
installer-constructor using Mono plus some home-grown glue code). So
malware that runs <em>on</em> Windows would have a very difficult time
attacking our build machine.
<li><strong>The names of the alleged viruses are too generic and too
varied to be plausible.</strong> If PuTTY really <em>was</em> infected
with some specific piece of malware, then I'd expect more than one
antivirus system to agree on what it was. Instead, every one of the
above reports has called us by a <em>different</em> name, and many of
those names look suspiciously non-specific. (A couple of them even say
‘Generic’; another outright admits to being a heuristic;
and the Rozena series looks more like some kind of cataloguing system
than a description of a specific piece of code).
<li><strong>We aren't doing anything malicious on purpose.</strong>
But of course you only have our word for that! Ultimately, if anyone
reading this does not trust our good intentions, there's nothing we
can do to convince you. All we can say is that PuTTY is free software,
so you have the last-ditch fallback option of reviewing the source
code for evidence of malice, and then doing your own builds from the
source you reviewed. Or, of course, using a different tool, if you
really feel there's no way you can trust our code.
</ul>



<p><hr>
If you want to comment on this web site, see the
<a href="../feedback.html">Feedback page</a>.
<br>
<div class="audit"><a href="https://git.tartarus.org/?p=simon/putty-wishlist.git;a=history;f=data/false-positive-malware;hb=refs/heads/main">Audit trail</a> for this semi-bug.</div>

<div class="timestamp">(last revision of this bug record was at 2021-09-07 21:50:22 +0100)</div>

</BODY></HTML>
